@model RealEstateApp.Application.Dtos.Account.UserRegisterDTO

@{
ViewData["Title"] = "Registro";
}

<div class="container my-5">
    <div class="bg-primary p-4 rounded shadow-lg text-white">
        <h2 class="text-center mb-4">Únete a la App</h2>

        <form id="registrationForm" asp-action="Register" method="post" enctype="multipart/form-data" class="shadow-lg p-4 rounded bg-light">
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="firstName" class="form-label text-dark">Nombre</label>
                    <input type="text" class="form-control" id="firstName" name="FirstName" value="@Model.FirstName" required placeholder="Ingresa tu nombre">
                </div>
                <div class="col-md-6">
                    <label for="lastName" class="form-label text-dark">Apellido</label>
                    <input type="text" class="form-control" id="lastName" name="LastName" value="@Model.LastName" required placeholder="Ingresa tu apellido">
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="phone" class="form-label text-dark">Teléfono</label>
                    <input type="tel" class="form-control" id="phone" name="PhoneNumber" value="@Model.PhoneNumber" required placeholder="Ingresa tu número de teléfono">
                </div>
                <div class="col-md-6">
                    <label for="photo" class="form-label text-dark">Foto de Usuario</label>
                    <input type="file" class="form-control" id="photo" name="Photo" accept=".jpg, .png" required>
                    <small class="text-muted">Solo se permiten archivos JPG o PNG</small>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="username" class="form-label text-dark">Nombre de Usuario</label>
                    <input type="text" class="form-control" id="username" name="Username" value="@Model.UserName" required placeholder="Elige tu nombre de usuario">
                </div>
                <div class="col-md-6">
                    <label for="email" class="form-label text-dark">Correo Electrónico</label>
                    <input type="email" class="form-control" id="email" name="Email" value="@Model.Email" required placeholder="Ingresa tu correo electrónico">
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="password" class="form-label text-dark">Contraseña</label>
                    <input type="password" class="form-control" id="password" name="Password" required placeholder="Ingresa tu contraseña">
                </div>
                <div class="col-md-6">
                    <label for="confirmPassword" class="form-label text-dark">Confirmar Contraseña</label>
                    <input type="password" class="form-control" id="confirmPassword" name="ConfirmPassword" required placeholder="Confirma tu contraseña">
                    <small id="passwordError" class="text-danger d-none">Las contraseñas no coinciden.</small>
                </div>
            </div>

            <div class="mb-3">
                <label for="role" class="form-label text-dark">Tipo de Usuario</label>
                <select class="form-select" id="role" name="Role" required>
                    <option value="Client">Cliente</option>
                    <option value="Agent">Agente</option>
                </select>
            </div>

            <div class="d-flex justify-content-between align-items-center">
                <button type="submit" class="btn btn-primary btn-lg">Registrar</button>
                <a href="/Account/Login" class="btn btn-link text-dark">¿Ya tienes cuenta? Iniciar sesión</a>
            </div>
        </form>
    </div>
</div>

<script>
    const form = document.getElementById("registrationForm");
    const password = document.getElementById("password");
    const confirmPassword = document.getElementById("confirmPassword");
    const passwordError = document.getElementById("passwordError");

    form.addEventListener("submit", function (event) {
        if (password.value !== confirmPassword.value) {
            event.preventDefault(); // Evita el envío del formulario
            passwordError.classList.remove("d-none"); // Muestra el mensaje de error
        } else {
            passwordError.classList.add("d-none"); // Oculta el mensaje de error si coinciden
        }
    });

    // Validación de archivo para la foto
    const photoInput = document.getElementById("photo");
    photoInput.addEventListener("change", function () {
        const file = this.files[0];
        if (file) {
            const fileType = file.type;
            if (fileType !== "image/jpeg" && fileType !== "image/png") {
                alert("Solo se permiten imágenes JPG o PNG.");
                this.value = ""; // Limpia el input
            }
        }
    });
</script>
